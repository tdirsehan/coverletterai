<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Academic Cover Letter Generator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 12px 32px rgba(0,0,0,0.11);
            padding: 28px;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 0.3em;
            font-size: 2.3em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 25px;
            font-size: 1.1em;
        }
        .api-section {
            background: #f0f4ff;
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
        }
        .api-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }
        @media (max-width: 600px) {
            .api-grid { grid-template-columns: 1fr; }
        }
        .api-provider {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .api-provider input[type="radio"] {
            width: auto;
            margin: 0;
        }
        form {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 22px;
            margin-bottom: 30px;
        }
        @media (max-width: 900px) {
            form { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 600px) {
            form { grid-template-columns: 1fr; }
            .container { padding: 12px; }
        }
        fieldset {
            border: 1.5px solid #e1e5e9;
            border-radius: 12px;
            padding: 18px;
            background: #fafafd;
            margin-bottom: 0;
        }
        legend {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
            margin-left: 8px;
        }
        .form-group {
            margin-bottom: 14px;
        }
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #444;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px 12px;
            border: 1.5px solid #e1e5e9;
            border-radius: 7px;
            font-size: 15px;
            background: #fff;
            margin-bottom: 2px;
            font-family: inherit;
        }
        textarea { resize: vertical; min-height: 70px; }
        .actions {
            display: flex;
            gap: 16px;
            margin: 30px 0 10px 0;
            justify-content: center;
            flex-wrap: wrap;
        }
        button {
            padding: 13px 24px;
            border-radius: 8px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: #fff;
            transition: background 0.2s, transform 0.2s;
        }
        button:hover:not(:disabled) { background: #764ba2; transform: translateY(-2px);}
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .output-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px 18px 12px 18px;
            margin-top: 16px;
            box-shadow: 0 2px 10px rgba(102,126,234,0.08);
        }
        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 14px;
        }
        .output-text {
            border-left: 3px solid #667eea;
            background: #fff;
            padding: 16px;
            border-radius: 7px;
            font-family: 'Georgia', serif;
            min-height: 130px;
            white-space: pre-wrap;
        }
        .word-count {
            text-align: right;
            margin-top: 10px;
            color: #666;
            font-size: 0.97em;
        }
        .copy-btn {
            background: #28a745;
            color: #fff;
            margin-left: 10px;
            font-size: 15px;
            padding: 7px 16px;
            border-radius: 6px;
        }
        .copy-btn:hover { background: #1e7e34; }
        .loading {
            text-align: center;
            color: #667eea;
            font-style: italic;
        }
        .error {
            background: #ffe6e6;
            border: 1px solid #ff9999;
            color: #cc0000;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background: #e6ffe6;
            border: 1px solid #99ff99;
            color: #006600;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .api-help {
            font-size: 0.9em;
            color: #666;
            margin-top: 10px;
        }
        .api-help a {
            color: #667eea;
            text-decoration: none;
        }
        .api-help a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AI-Powered Cover Letter Generator</h1>
        <div class="subtitle">
            Real AI Integration with Gemini & Hugging Face &mdash; Free ‚Ä¢ Powerful ‚Ä¢ Intelligent
        </div>
        
        <div class="api-section">
            <h3 style="margin-top: 0; color: #667eea;">ü§ñ AI Configuration</h3>
            
            <div class="api-provider">
                <input type="radio" id="gemini" name="aiProvider" value="gemini" checked>
                <label for="gemini">Google Gemini (Recommended)</label>
            </div>
            <div class="api-provider">
                <input type="radio" id="huggingface" name="aiProvider" value="huggingface">
                <label for="huggingface">Hugging Face</label>
            </div>
            
            <div class="api-grid">
                <div class="form-group">
                    <label for="geminiKey">Gemini API Key</label>
                    <input type="password" id="geminiKey" placeholder="AIza...">
                </div>
                <div class="form-group">
                    <label for="huggingfaceKey">Hugging Face Token</label>
                    <input type="password" id="huggingfaceKey" placeholder="hf_...">
                </div>
            </div>
            
            <div class="api-help">
                üìù <strong>Free API Keys:</strong><br>
                ‚Ä¢ Gemini: <a href="https://aistudio.google.com/app/apikey" target="_blank">Get free API key from Google AI Studio</a><br>
                ‚Ä¢ Hugging Face: <a href="https://huggingface.co/settings/tokens" target="_blank">Create free token on Hugging Face</a>
            </div>
        </div>

        <form id="coverForm" autocomplete="off">
            <fieldset>
                <legend>Author Information</legend>
                <div class="form-group">
                    <label for="authors">Authors</label>
                    <input type="text" id="authors" placeholder="Dr. Sarah Johnson, Dr. Michael Chen" required>
                </div>
                <div class="form-group">
                    <label for="correspondingMain">Corresponding Author</label>
                    <input type="text" id="correspondingMain" placeholder="Dr. Sarah Johnson" required>
                </div>
                <div class="form-group">
                    <label for="correspondingTitle">Author Title/Position</label>
                    <input type="text" id="correspondingTitle" placeholder="Professor of Computer Science">
                </div>
                <div class="form-group">
                    <label for="affiliation">Institution/Affiliation</label>
                    <input type="text" id="affiliation" placeholder="University of Technology">
                </div>
                <div class="form-group">
                    <label for="contactEmail">Contact Email</label>
                    <input type="email" id="contactEmail" placeholder="sarah.johnson@university.edu">
                </div>
            </fieldset>
            <fieldset>
                <legend>Manuscript Information</legend>
                <div class="form-group">
                    <label for="title">Manuscript Title</label>
                    <input type="text" id="title" required>
                </div>
                <div class="form-group">
                    <label for="manuscriptType">Manuscript Type</label>
                    <select id="manuscriptType">
                        <option value="original">Original Research Paper</option>
                        <option value="review">Review Article</option>
                        <option value="letter">Letter/Brief Communication</option>
                        <option value="case-study">Case Study</option>
                        <option value="perspective">Perspective/Opinion</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="abstract">Abstract/Research Summary</label>
                    <textarea id="abstract" placeholder="Research summary..."></textarea>
                </div>
                <div class="form-group">
                    <label for="keywords">Keywords</label>
                    <input type="text" id="keywords" placeholder="machine learning, climate prediction">
                </div>
                <div class="form-group">
                    <label for="wordCountInput">Word Count</label>
                    <input type="number" id="wordCountInput" min="0" placeholder="5000">
                </div>
            </fieldset>
            <fieldset>
                <legend>Journal & Editor Info</legend>
                <div class="form-group">
                    <label for="journal">Journal Name</label>
                    <input type="text" id="journal" required>
                </div>
                <div class="form-group">
                    <label for="editor">Target Editor</label>
                    <input type="text" id="editor">
                </div>
                <div class="form-group">
                    <label for="scope">Journal Aims & Scope</label>
                    <textarea id="scope" placeholder="Aims & scope"></textarea>
                </div>
                <div class="form-group">
                    <label for="letterLength">Letter Length</label>
                    <select id="letterLength">
                        <option value="standard">Standard (~500 words)</option>
                        <option value="short">Short (~300 words)</option>
                        <option value="long">Long (~750 words)</option>
                    </select>
                </div>
            </fieldset>
        </form>
        <div class="actions">
            <button type="button" id="generateBtn" onclick="generateCoverLetter()">üöÄ Generate with AI</button>
            <button type="button" class="copy-btn" onclick="copyToClipboard()">üìã Copy Output</button>
            <button type="button" onclick="generateTemplate()" style="background: #6c757d;">üìù Use Template</button>
        </div>
        
        <div id="statusDiv"></div>
        
        <div class="output-section">
            <div class="output-header">
                <div><strong>Generated Cover Letter</strong></div>
                <div class="word-count" id="wordCount">Word count: 0</div>
            </div>
            <div class="output-text" id="output">Your AI-generated cover letter will appear here...</div>
        </div>
    </div>
    <script>
        function countWords(str) {
            return str.trim().length === 0 ? 0 : str.trim().split(/\s+/).length;
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('statusDiv');
            statusDiv.innerHTML = `<div class="${type}">${message}</div>`;
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }

        function createPrompt() {
            const data = {
                authors: document.getElementById('authors').value || "[Authors]",
                corresponding: document.getElementById('correspondingMain').value || "[Corresponding Author]",
                title: document.getElementById('title').value || "[Manuscript Title]",
                journal: document.getElementById('journal').value || "[Journal Name]",
                editor: document.getElementById('editor').value || "Editor",
                scope: document.getElementById('scope').value || "[Journal scope]",
                abstract: document.getElementById('abstract').value || "[Abstract]",
                keywords: document.getElementById('keywords').value || "[Keywords]",
                manuscriptType: document.getElementById('manuscriptType').value,
                affiliation: document.getElementById('affiliation').value || "[Institution]",
                position: document.getElementById('correspondingTitle').value || "[Position]",
                letterLength: document.getElementById('letterLength').value
            };

            const lengthGuide = {
                'short': 'approximately 300 words',
                'standard': 'approximately 500 words',  
                'long': 'approximately 750 words'
            };

            return `Write a professional academic cover letter for journal submission with the following details:

**Manuscript Information:**
- Title: "${data.title}"
- Authors: ${data.authors}
- Corresponding Author: ${data.corresponding}
- Position: ${data.position}
- Institution: ${data.affiliation}
- Manuscript Type: ${data.manuscriptType}
- Keywords: ${data.keywords}

**Journal Information:**
- Journal Name: ${data.journal}
- Target Editor: ${data.editor}
- Journal Aims & Scope: ${data.scope}

**Research Summary:**
${data.abstract}

**Requirements:**
- Length: ${lengthGuide[data.letterLength]}
- Professional, academic tone
- Highlight the significance and novelty of the research
- Explain how the work fits the journal's scope
- Include proper academic formatting
- Address the editor appropriately
- End with a professional closing

Write a compelling cover letter that will increase the chances of manuscript acceptance.`;
        }

        async function callGeminiAPI(prompt, apiKey) {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1024,
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`Gemini API Error: ${response.status} - ${response.statusText}`);
            }

            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        async function callHuggingFaceAPI(prompt, token) {
            const response = await fetch("https://api-inference.huggingface.co/models/microsoft/DialoGPT-large", {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    inputs: prompt,
                    parameters: {
                        max_length: 1000,
                        temperature: 0.7,
                        do_sample: true,
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`Hugging Face API Error: ${response.status} - ${response.statusText}`);
            }

            const data = await response.json();
            if (data.error) {
                throw new Error(`Hugging Face Error: ${data.error}`);
            }
            return data[0].generated_text.replace(prompt, '').trim();
        }

        async function generateCoverLetter() {
            const generateBtn = document.getElementById('generateBtn');
            const provider = document.querySelector('input[name="aiProvider"]:checked').value;
            
            const geminiKey = document.getElementById('geminiKey').value;
            const hfToken = document.getElementById('huggingfaceKey').value;

            if (provider === 'gemini' && !geminiKey) {
                showStatus('Please enter your Gemini API key', 'error');
                return;
            }
            if (provider === 'huggingface' && !hfToken) {
                showStatus('Please enter your Hugging Face token', 'error');
                return;
            }

            generateBtn.disabled = true;
            generateBtn.textContent = 'ü§ñ Generating...';
            showStatus('AI is generating your cover letter...', 'loading');

            try {
                const prompt = createPrompt();
                let result;

                if (provider === 'gemini') {
                    result = await callGeminiAPI(prompt, geminiKey);
                } else {
                    result = await callHuggingFaceAPI(prompt, hfToken);
                }

                document.getElementById('output').textContent = result;
                document.getElementById('wordCount').textContent = `Word count: ${countWords(result)}`;
                showStatus('‚úÖ Cover letter generated successfully!', 'success');
            } catch (error) {
                console.error('API Error:', error);
                showStatus(`‚ùå Error: ${error.message}`, 'error');
                
                // Fallback to template
                generateTemplate();
                showStatus('‚ö†Ô∏è Used template fallback due to API error', 'error');
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'üöÄ Generate with AI';
            }
        }

        function generateTemplate() {
            const author = document.getElementById('authors').value || "[Authors]";
            const corr = document.getElementById('correspondingMain').value || "[Corresponding Author]";
            const title = document.getElementById('title').value || "[Title]";
            const journal = document.getElementById('journal').value || "[Journal]";
            const scope = document.getElementById('scope').value || "[Scope]";
            const abstract = document.getElementById('abstract').value || "[Abstract]";
            const keywords = document.getElementById('keywords').value || "[Keywords]";
            const editor = document.getElementById('editor').value || "Editor";

            let letter = `Dear ${editor},

We are pleased to submit our manuscript entitled "${title}" for consideration for publication in ${journal}. This work, authored by ${author}, presents significant advances in its field and aligns well with the journal's scope.

${scope ? `Our research directly contributes to the journal's focus areas: ${scope}.` : ''}

Abstract Summary:
${abstract}

Key findings include novel insights that will be of significant interest to your readership. We believe this work makes an important contribution to the field and hope you will consider it for publication in ${journal}.

The manuscript includes the following keywords: ${keywords}

We confirm that this work is original, has not been published elsewhere, and is not under consideration by any other journal. All authors have approved the submission.

Thank you for your consideration. We look forward to your response.

Sincerely,
${corr}
${document.getElementById('correspondingTitle').value ? document.getElementById('correspondingTitle').value : ''}
${document.getElementById('affiliation').value ? document.getElementById('affiliation').value : ''}
${document.getElementById('contactEmail').value ? document.getElementById('contactEmail').value : ''}`;

            document.getElementById('output').textContent = letter;
            document.getElementById('wordCount').textContent = `Word count: ${countWords(letter)}`;
        }

        function copyToClipboard() {
            const output = document.getElementById('output').textContent;
            if (output.trim() === 'Your AI-generated cover letter will appear here...') {
                showStatus('Please generate a cover letter first', 'error');
                return;
            }
            
            navigator.clipboard.writeText(output).then(() => {
                showStatus('üìã Cover letter copied to clipboard!', 'success');
            }, () => {
                showStatus('‚ùå Failed to copy to clipboard', 'error');
            });
        }

        // Form validation and word count updates
        document.getElementById('coverForm').addEventListener('input', () => {
            const output = document.getElementById('output').textContent;
            if (output !== 'Your AI-generated cover letter will appear here...') {
                document.getElementById('wordCount').textContent = `Word count: ${countWords(output)}`;
            }
        });

        // Auto-save API keys to localStorage (if available)
        document.getElementById('geminiKey').addEventListener('input', (e) => {
            try {
                localStorage.setItem('gemini_api_key', e.target.value);
            } catch (e) {
                // Ignore localStorage errors in artifacts
            }
        });

        document.getElementById('huggingfaceKey').addEventListener('input', (e) => {
            try {
                localStorage.setItem('hf_token', e.target.value);
            } catch (e) {
                // Ignore localStorage errors in artifacts
            }
        });

        // Load saved keys on page load
        window.addEventListener('load', () => {
            try {
                const savedGeminiKey = localStorage.getItem('gemini_api_key');
                const savedHfToken = localStorage.getItem('hf_token');
                if (savedGeminiKey) document.getElementById('geminiKey').value = savedGeminiKey;
                if (savedHfToken) document.getElementById('huggingfaceKey').value = savedHfToken;
            } catch (e) {
                // Ignore localStorage errors in artifacts
            }
        });
    </script>
</body>
</html>
